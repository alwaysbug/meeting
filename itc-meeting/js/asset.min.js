api.userPost("user/me",{},myCompany);function myCompany(a){if(a.data.user.companies.length>1){$(".down_arrow").show()}$(".company").html(a.data.user.companies[0].companyName);$(".user").html(a.data.user.user.nickname)}$(".user_loginOut_icon").on("click",function(){$("#login_out").modal("show")});$(".login_out_btn").on("click",function(){api.userPost("auth/logout",{},function(){window.location.href="register.html?login"})});var tipsSlideSpeed=200;$(".user_news_icon").on("click",function(){$(".person_sets").slideUp(tipsSlideSpeed);$(".companys").slideUp(tipsSlideSpeed);$(".person_tips").slideToggle(tipsSlideSpeed)});$(".user_set_icon").on("click",function(){$(".person_tips").slideUp(tipsSlideSpeed);$(".companys").slideUp(tipsSlideSpeed);$(".person_sets").slideToggle(tipsSlideSpeed)});$(".down_arrow").on("click",function(){$(".person_sets").slideUp(tipsSlideSpeed);$(".person_tips").slideUp(tipsSlideSpeed);$(".companys").slideToggle(tipsSlideSpeed)});$(".companys").on("click","li",function(){$(".companys").slideUp(tipsSlideSpeed)});$(".wrap").on("click",function(){$(".tips").slideUp(tipsSlideSpeed);$(".companys").slideUp(tipsSlideSpeed)});$(".slide-wrapper").on("click",function(){$(".tips").slideUp(tipsSlideSpeed)});$(".sureChange").on("click",function(){var a={"old_password":$(".oldpassword").val(),"new_password":$(".newpassword").val()};api.userPost("user/password",a,function(b){$(".tips_text").html(b.message);$("#no_groups").modal("show");$(".tips").slideUp(200)})});var thisObjGlobal=null;var tree=null;var setting={view:{showIcon:false,showTitle:false,showLine:false,},callback:{onClick:clickNode},data:{simpleData:{enable:true}},};api.get("equipmentCategory/lists",{},groupAll);function groupAll(f){$("#zTree").children().remove();var c=f.data;var e=[];var b={name:"资产分类",open:true,dataId:"0"};var g=JSON.stringify(c);var a=g.replace(/\"id\"/g,'"dataId"');var d=JSON.parse(a);b.children=d;e.push(b);$.fn.zTree.init($("#zTree"),setting,e);tree=$.fn.zTree.getZTreeObj("zTree")}function clickNode(a,c,b){if(b.level==0){$(".add_equip_btn").hide();$(".edit_equip_groups_btn").hide();$(".add_equip_groups_btn").show()}else{$(".add_equip_groups_btn").hide();$(".edit_equip_groups_btn").show();$(".add_equip_btn").show()}}$(".edit_equip_groups_btn").on("click",function(){$(".sidebar").hide();slideShow($(".edit_equips_groups"))});$(".sava_edit_eq_group").on("click",function(){var a={"name":$(".edit_eq_group_name").val(),"id":tree.getSelectedNodes()[0].dataId};api.userPost("equipmentCategory/update",a,function(b){if(b.code==0){alert("修改成功！");api.get("equipmentCategory/lists",{},groupAll)}})});$(".delete_edit_eq_group").on("click",function(){slideHide()});$(".delete_edit_eq_group").on("click",function(){if(confirm("确定删除分组？")){var a={"id":thisObjGlobal.id};api.deleteIt("equipmentCategory/delete",a,function(b){console.log(b)})}});$(".add_equip_btn").on("click",function(){$(".sidebar").hide();slideShow($(".add_equipment"))});$(".add_eq_cancel").on("click",function(){slideHide()});$(".upload_equips_btn").on("click",function(){$(".sidebar").hide();slideShow($(".upload_equipments"))});$(".add_equip_groups_btn").on("click",function(){$(".sidebar").hide();slideShow($(".add_equips_groups"))});$(".delete_group_cancel").on("click",function(){slideHide()});$(".sava_eq_group").on("click",function(){var a={"name":$(".eq_group_name").val()};api.userPost("equipmentCategory/create",a,function(b){if(b.code==0){alert("创建成功！");$(".slide-wrapper").hide();api.get("equipmentCategory/lists",{},groupAll)}else{alert(b.message)}})});$(".delete_more").on("click",function(){if($(".check:checked").length==0){$(".notice_text").html("未选择设备");$("#notice").modal("show");delayDisapper(800)}else{$("#delete_device_checked").modal("show")}});$(".delete_this_device").on("click",function(){$("#delete_device_checked").modal("hide")});function delayDisapper(a){setTimeout(function(){$("#notice").modal("hide")},a)}var $clear_val=$(".clear_val");var $search=$(".search");var slide_speed=100;$search.on("input",function(){if($(this).val()!=""){$clear_val.slideDown(slide_speed)}else{$clear_val.slideUp(slide_speed)}});$clear_val.on("click",function(){$search.val("");$clear_val.slideUp(slide_speed);$("#tree").treeview("clearSearch")});var slideDiv=$(".sidebar");var slideMask=$(".slide-mask");function slideShow(a){slideMask.show();a.show();slideDiv.animate({"right":"0",},250)}function slideHide(){slideMask.hide();slideDiv.animate({"right":"-500",},250);setTimeout(function(){slideDiv.hide()},250)}slideMask.on("click",function(){slideHide()});